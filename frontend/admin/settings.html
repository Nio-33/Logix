<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Settings - Logix</title>
    <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
    <link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" onload="this.rel='stylesheet'" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#044595",
                        "background-light": "#f5f7f8",
                        "background-dark": "#0f1823",
                    },
                    fontFamily: {
                        display: ["Inter"],
                    },
                    borderRadius: { DEFAULT: "0.25rem", lg: "0.5rem", xl: "0.75rem", full: "9999px" },
                },
            },
        }
    </script>
    <style>
        .switch {
            position: relative;
            display: inline-block;
            width: 3rem;
            height: 1.75rem;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 1.25rem;
            width: 1.25rem;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }
        input:checked + .slider {
            background-color: #044595;
        }
        input:focus + .slider {
            box-shadow: 0 0 1px #044595;
        }
        input:checked + .slider:before {
            -webkit-transform: translateX(1.25rem);
            -ms-transform: translateX(1.25rem);
            transform: translateX(1.25rem);
        }
        .slider.round {
            border-radius: 1.75rem;
        }
        .slider.round:before {
            border-radius: 50%;
        }
    </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-gray-800 dark:text-gray-200">
    <div class="flex min-h-screen">
        <aside class="w-64 bg-background-light dark:bg-background-dark border-r border-gray-200 dark:border-gray-800 flex flex-col">
            <div class="p-6 flex items-center gap-3">
                <div class="w-8 h-8 text-primary">
                    <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                        <path d="M44 11.2727C44 14.0109 39.8386 16.3957 33.69 17.6364C39.8386 18.877 44 21.2618 44 24C44 26.7382 39.8386 29.123 33.69 30.3636C39.8386 31.6043 44 33.9891 44 36.7273C44 40.7439 35.0457 44 24 44C12.9543 44 4 40.7439 4 36.7273C4 33.9891 8.16144 31.6043 14.31 30.3636C8.16144 29.123 4 26.7382 4 24C4 21.2618 8.16144 18.877 14.31 17.6364C8.16144 16.3957 4 14.0109 4 11.2727C4 7.25611 12.9543 4 24 4C35.0457 4 44 7.25611 44 11.2727Z" fill="currentColor"></path>
                    </svg>
                </div>
                <h1 class="text-xl font-bold text-gray-900 dark:text-white">Logix</h1>
            </div>
            <nav class="flex-1 px-4 py-2 space-y-1">
                <a class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-gray-600 dark:text-gray-300 hover:bg-primary/10 hover:text-primary dark:hover:bg-primary/20" href="/admin">
                    <span class="material-symbols-outlined">dashboard</span>
                    Dashboard
                </a>
                <a class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-gray-600 dark:text-gray-300 hover:bg-primary/10 hover:text-primary dark:hover:bg-primary/20" href="/admin/orders">
                    <span class="material-symbols-outlined">inventory_2</span>
                    Orders
                </a>
                <a class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-gray-600 dark:text-gray-300 hover:bg-primary/10 hover:text-primary dark:hover:bg-primary/20" href="/admin/inventory">
                    <span class="material-symbols-outlined">warehouse</span>
                    Inventory
                </a>
                <a class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-gray-600 dark:text-gray-300 hover:bg-primary/10 hover:text-primary dark:hover:bg-primary/20" href="/admin/routes">
                    <span class="material-symbols-outlined">map</span>
                    Routes
                </a>
                <a class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-gray-600 dark:text-gray-300 hover:bg-primary/10 hover:text-primary dark:hover:bg-primary/20" href="/admin/analytics">
                    <span class="material-symbols-outlined">monitoring</span>
                    Analytics
                </a>
                <a class="flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-lg text-gray-600 dark:text-gray-300 hover:bg-primary/10 hover:text-primary dark:hover:bg-primary/20" href="/admin/users">
                    <span class="material-symbols-outlined">group</span>
                    Users
                </a>
            </nav>
            <div class="px-4 py-4">
                <a class="flex items-center gap-3 px-4 py-2 rounded-lg bg-primary text-white" href="/admin/settings">
                    <span class="material-symbols-outlined">settings</span>
                    Settings
                </a>
            </div>
        </aside>
        
        <!-- Main Content -->
        <div class="flex-1 flex flex-col">
            <!-- Header -->
            <header class="flex items-center justify-end h-16 px-6 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center gap-4">
                    <!-- Notifications Bell -->
                    <div class="relative">
                        <button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800" onclick="toggleNotifications()">
                            <svg class="w-6 h-6 text-gray-600 dark:text-gray-300" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
                                <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
                            </svg>
                            <span class="absolute -top-2 -right-2 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white">5</span>
                        </button>
                        <div id="notificationDropdown" class="absolute right-0 mt-2 w-80 sm:w-96 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg overflow-hidden hidden">
                            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                                <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Notifications</h3>
                            </div>
                            <div class="divide-y divide-gray-200 dark:divide-gray-700">
                                <div class="p-4 flex items-start gap-4 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors duration-200">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center">
                                        <svg class="h-6 w-6 text-blue-500 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-sm text-gray-800 dark:text-gray-200">New order <span class="font-semibold text-blue-600">#12345</span> received.</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">2024-01-20 10:00 AM</p>
                                    </div>
                                </div>
                                <div class="p-4 flex items-start gap-4 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors duration-200">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/50 flex items-center justify-center">
                                        <svg class="h-6 w-6 text-yellow-500 dark:text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-sm text-gray-800 dark:text-gray-200">Shipment for order <span class="font-semibold text-blue-600">#67890</span> has been delayed.</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">2024-01-19 03:30 PM</p>
                                    </div>
                                </div>
                                <div class="p-4 flex items-start gap-4 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors duration-200">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/50 flex items-center justify-center">
                                        <svg class="h-6 w-6 text-green-500 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-sm text-gray-800 dark:text-gray-200">Order <span class="font-semibold text-blue-600">#112233</span> was successfully delivered.</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">2024-01-18 09:15 AM</p>
                                    </div>
                                </div>
                            </div>
                            <div class="p-2 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50">
                                <a class="block w-full text-center text-sm font-medium text-blue-600 hover:underline" href="#">View all notifications</a>
                            </div>
                        </div>
                    </div>
                    <!-- Profile Picture -->
                    <div class="w-10 h-10 bg-center bg-no-repeat bg-cover rounded-full cursor-pointer" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAoY_LeVqkHngNlltFp_1UZ3vSQmkAdYW6lUUd_bNe4XyaJMLexoWuNIfHCwWe_JXLZcwEZ3ESXuSHuRCd9rPz1VMi5ZFOqSXSfKG3eQkukViPU-be0W24hM1hdVgVWbuJjX0gJFPpvMW33-a5GHvDbCtC92vEB6uTyXzbHNo4e6CmNW49rFok28174tqKadowfcYO2nTPPvN_SSZ-VO6Fco7OacqXMc1UNFw_plx2r65m2YZWlprzR5PdXc0Ma9-xBAuhNXcGgI8KO");' onclick="window.location.href='/admin/profile'"></div>
                </div>
            </header>
            
            <!-- Main Content Area -->
            <main class="flex-1 p-8">
                <div class="max-w-4xl mx-auto">
                    <h1 class="text-3xl font-bold mb-8">System Settings</h1>
                    <div class="space-y-8">
                        <!-- Notifications Section -->
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm">
                            <h2 class="text-xl font-bold mb-4">Notifications</h2>
                            <p class="text-sm text-gray-500 dark:text-gray-400 mb-6">Manage how you receive updates and alerts.</p>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <label class="font-medium" for="email-alerts">Email Alerts</label>
                                    <label class="switch">
                                        <input type="checkbox" id="email-alerts" checked>
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <label class="font-medium" for="push-notifications">Push Notifications</label>
                                    <label class="switch">
                                        <input type="checkbox" id="push-notifications">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- General Preferences Section -->
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm">
                            <h2 class="text-xl font-bold mb-4">General Preferences</h2>
                            <p class="text-sm text-gray-500 dark:text-gray-400 mb-6">Customize your application's appearance and behavior.</p>
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1" for="theme-selection">Theme Selection</label>
                                    <select id="theme-selection" class="w-full bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                        <option>Light</option>
                                        <option>Dark</option>
                                        <option>System Default</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1" for="language-preference">Language Preference</label>
                                    <select id="language-preference" class="w-full bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                                        <option>English (US)</option>
                                        <option>Spanish</option>
                                        <option>French</option>
                                        <option>German</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Integrations Section -->
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm">
                            <h2 class="text-xl font-bold mb-4">Integrations</h2>
                            <p class="text-sm text-gray-500 dark:text-gray-400 mb-6">Connect with other services to enhance functionality.</p>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-900">
                                    <div class="flex items-center gap-4">
                                        <div class="w-8 h-8 bg-gray-200 rounded flex items-center justify-center">
                                            <svg class="w-5 h-5 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z"/>
                                            </svg>
                                        </div>
                                        <div>
                                            <h3 class="font-medium">Slack</h3>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Receive notifications directly in your Slack channels.</p>
                                        </div>
                                    </div>
                                    <button class="px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900 rounded hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors">Connect</button>
                                </div>
                                <div class="flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-900">
                                    <div class="flex items-center gap-4">
                                        <div class="w-8 h-8 bg-green-500 rounded flex items-center justify-center">
                                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M15.337 0C11.636 0 8.74 2.895 8.74 6.6c0 1.566.49 3.02 1.32 4.22L12 13.5l1.94-2.68c.83-1.2 1.32-2.654 1.32-4.22C16.26 2.895 13.364 0 9.663 0zm0 9.6c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"/>
                                            </svg>
                                        </div>
                                        <div>
                                            <h3 class="font-medium">Shopify</h3>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Sync orders and inventory with your Shopify store.</p>
                                        </div>
                                    </div>
                                    <button class="px-4 py-2 text-sm font-medium text-green-600 bg-green-100 dark:bg-green-900/50 rounded cursor-not-allowed">Connected</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-8 flex justify-end">
                        <button class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-colors">Save Changes</button>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        // Notifications functionality
        function toggleNotifications() {
            const dropdown = document.getElementById('notificationDropdown');
            dropdown.classList.toggle('hidden');
        }
        
        // Close notifications dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('notificationDropdown');
            const button = event.target.closest('button[onclick="toggleNotifications()"]');
            
            if (!button && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });
        
        // Settings page functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Toggle switches functionality
            const emailAlerts = document.getElementById('email-alerts');
            const pushNotifications = document.getElementById('push-notifications');
            
            // Theme selection functionality
            const themeSelection = document.getElementById('theme-selection');
            
            // Language preference functionality
            const languagePreference = document.getElementById('language-preference');
            
            // Save changes button
            const saveButton = document.querySelector('button[class*="bg-blue-600"]');
            
            // Handle toggle switches
            if (emailAlerts) {
                emailAlerts.addEventListener('change', function() {
                    console.log('Email alerts:', this.checked ? 'enabled' : 'disabled');
                });
            }
            
            if (pushNotifications) {
                pushNotifications.addEventListener('change', function() {
                    console.log('Push notifications:', this.checked ? 'enabled' : 'disabled');
                });
            }
            
            // Handle theme selection
            if (themeSelection) {
                themeSelection.addEventListener('change', function() {
                    const selectedTheme = this.value;
                    console.log('Theme changed to:', selectedTheme);
                    
                    // Use theme manager to apply theme
                    if (window.themeManager) {
                        window.themeManager.saveTheme(selectedTheme);
                    } else {
                        // Fallback if theme manager not loaded
                        applyTheme(selectedTheme);
                    }
                });
            }
            
            // Handle language preference
            if (languagePreference) {
                languagePreference.addEventListener('change', function() {
                    console.log('Language changed to:', this.value);
                });
            }
            
            // Handle save changes
            if (saveButton) {
                saveButton.addEventListener('click', function() {
                    console.log('Saving settings...');
                    
                    // Collect all settings
                    const settings = {
                        emailAlerts: emailAlerts ? emailAlerts.checked : false,
                        pushNotifications: pushNotifications ? pushNotifications.checked : false,
                        theme: themeSelection ? themeSelection.value : 'Light',
                        language: languagePreference ? languagePreference.value : 'English (US)'
                    };
                    
                    // Save settings to localStorage
                    localStorage.setItem('logix_settings', JSON.stringify(settings));
                    
                    // Apply theme immediately using theme manager
                    if (window.themeManager) {
                        window.themeManager.saveTheme(settings.theme);
                    } else {
                        applyTheme(settings.theme);
                    }
                    
                    console.log('Settings saved:', settings);
                    
                    // Show success message
                    const successMessage = document.createElement('div');
                    successMessage.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                    successMessage.textContent = 'Settings saved successfully!';
                    document.body.appendChild(successMessage);
                    
                    // Remove success message after 3 seconds
                    setTimeout(() => {
                        successMessage.remove();
                    }, 3000);
                });
            }
            
            // Theme application function
            function applyTheme(theme) {
                if (theme === 'Dark') {
                    document.documentElement.classList.add('dark');
                } else if (theme === 'Light') {
                    document.documentElement.classList.remove('dark');
                } else if (theme === 'System Default') {
                    // Use system preference
                    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        document.documentElement.classList.add('dark');
                    } else {
                        document.documentElement.classList.remove('dark');
                    }
                }
                
                // Save theme preference for other pages
                localStorage.setItem('logix_theme', theme);
            }
            
            // Load saved settings on page load
            function loadSettings() {
                const savedSettings = localStorage.getItem('logix_settings');
                if (savedSettings) {
                    const settings = JSON.parse(savedSettings);
                    
                    // Apply saved settings to form
                    if (themeSelection) {
                        themeSelection.value = settings.theme || 'Light';
                        if (window.themeManager) {
                            window.themeManager.applyTheme(settings.theme);
                        } else {
                            applyTheme(settings.theme);
                        }
                    }
                    if (emailAlerts) {
                        emailAlerts.checked = settings.emailAlerts || false;
                    }
                    if (pushNotifications) {
                        pushNotifications.checked = settings.pushNotifications || false;
                    }
                    if (languagePreference) {
                        languagePreference.value = settings.language || 'English (US)';
                    }
                } else {
                    // Default theme loading
                    const savedTheme = localStorage.getItem('logix_theme') || localStorage.getItem('theme') || 'Light';
                    if (themeSelection) {
                        themeSelection.value = savedTheme;
                        if (window.themeManager) {
                            window.themeManager.applyTheme(savedTheme);
                        } else {
                            applyTheme(savedTheme);
                        }
                    }
                }
            }
            
            // Load settings when page loads
            loadSettings();
            
            // Integration buttons
            const slackConnect = document.querySelector('button[class*="text-blue-600 dark:text-blue-400"]');
            if (slackConnect && slackConnect.textContent === 'Connect') {
                slackConnect.addEventListener('click', function() {
                    console.log('Connecting to Slack...');
                    alert('Slack integration would be connected here');
                });
            }
        });
    </script>
<script src="/shared/utils/auth-guard.js"></script>
<script src="/shared/utils/theme-manager.js"></script>
</body>
</html>